import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{c as w}from"./compiler-runtime-CJbQ6yvW.js";import{M as j}from"./ModeSwitcher-DE7fG3jj.js";import{p as k,T as S}from"./TimerControls-BxdhOrAQ.js";import{T as v}from"./TimerDisplay-vjCVDni9.js";import{P as I}from"./ProgressRing-DOSM5Dml.js";import{T as C}from"./Text-C1JEmKLm.js";import{I as D}from"./InfoTooltip-eUu06fOe.js";import{u as b}from"./PomodoroContext-DcQYR8jO.js";import{r as _}from"./index-BE4Fbmwm.js";import{v as L}from"./v4-C6aID195.js";const M="_container_6qrrh_1",N="_titleRow_6qrrh_9",T={container:M,titleRow:N};function E(e,n=Date.now()){return Math.round(((e??n)-n)/1e3)}const q=()=>{const{isRunning:e,setIsRunning:n,setTimeLeft:c,timeLeft:f,mode:m,setMode:h,pomodoroCount:p,setPomodoroCount:u,incrementCompletedPomodoros:s,setGlobalPomodoros:d}=b(),o=_.useRef(null),t=_.useRef(!1),r=_.useRef(!1),l=_.useRef(null),i=()=>{o.current&&(clearInterval(o.current),o.current=null)},g=()=>{if(m==="pomodoro"){const R=p+1;u(R),h(R%4===0?"long_break":"short_break")}else h("pomodoro")};_.useEffect(()=>{if(i(),e){const R=Date.now(),y=f;l.current=R+y*1e3,t.current=!1,r.current=!1,o.current=setInterval(()=>{const x=E(l.current,Date.now());if(x<=0){t.current||(k(),t.current=!0),Notification.permission==="granted"&&new Notification("Time's up!",{body:m==="pomodoro"?"Take a short break!":"Ready to focus? Start your next Pomodoro!"}),!r.current&&m==="pomodoro"&&(s(),d(P=>[...P,{id:L(),completedAt:new Date().toISOString()}]),r.current=!0),i(),c(0),n(!1),g();return}c(x)},1e3)}return i},[e])},A=()=>{const e=w.c(16);q();const{timeLeft:n,mode:c}=b();let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f={pomodoro:"Pomodoro",short_break:"Short Break",long_break:"Long Break"},e[0]=f):f=e[0];const m=f[c],p=1-n/(c==="pomodoro"?1500:c==="short_break"?300:900);let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u=a.jsx(j,{}),e[1]=u):u=e[1];let s;e[2]!==m?(s=a.jsx(C,{variant:"label",children:m}),e[2]=m,e[3]=s):s=e[3];let d;e[4]===Symbol.for("react.memo_cache_sentinel")?(d=a.jsx(D,{}),e[4]=d):d=e[4];let o;e[5]!==s?(o=a.jsxs("div",{className:T.titleRow,children:[s,d]}),e[5]=s,e[6]=o):o=e[6];let t;e[7]!==n?(t=a.jsx(v,{time:n}),e[7]=n,e[8]=t):t=e[8];let r;e[9]!==p||e[10]!==t?(r=a.jsx(I,{radius:120,stroke:6,progress:p,children:t}),e[9]=p,e[10]=t,e[11]=r):r=e[11];let l;e[12]===Symbol.for("react.memo_cache_sentinel")?(l=a.jsx(S,{}),e[12]=l):l=e[12];let i;return e[13]!==o||e[14]!==r?(i=a.jsxs("div",{className:T.container,children:[u,o,r,l]}),e[13]=o,e[14]=r,e[15]=i):i=e[15],i};A.__docgenInfo={description:"",methods:[],displayName:"PomodoroTimer"};export{A as P};
